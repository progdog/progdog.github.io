
  
<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="siteBaseUrl" content="https://thats-it-code.com">
    <meta name="author" content="go3boy">
    <meta name="description" content="python,pandas,programming,tips,tricks,code snippets,code sample,code example, Azure, Form Recognizer, Playwright,  Power Apps, OCR, openpyxl, Apache Spark">
    <meta name="keywords" content="python,pandas,programming,tips,tricks,code snippets,code sample,code example, Azure, Form Recognizer, Playwright,  Power Apps, OCR, openpyxl, Apache Spark">
    <meta name="generator" content="Hugo 0.91.2" />
    <title>
        
           
               How to Extract Items of Invoice Using Form Recognizer API &vert; That&#39;s it ! Code Snippets
           
        
    </title>
    <meta name="description" content="Using Azure Form Recognizer Python OCR API to extract items from an invoice (local image). ">
    <meta itemprop="name" content="How to Extract Items of Invoice Using Form Recognizer API">
    <meta itemprop="description" content="Using Azure Form Recognizer Python OCR API to extract items from an invoice (local image). ">
    <meta property="og:title" content="How to Extract Items of Invoice Using Form Recognizer API">
    <meta property="og:description" content="Using Azure Form Recognizer Python OCR API to extract items from an invoice (local image). ">
    <meta property="og:image" content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200">
    <meta property="og:url" content="https://thats-it-code.com/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/">
    <meta property="og:site_name" content="That&#39;s it ! Code Snippets">
    <meta property="og:type" content="article">

    


    <script src="/modernizr-simple.js"></script>

    
    <link href="/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/" rel="alternate" type="application/rss+xml" title="That&#39;s it ! Code Snippets" />
    <link href="/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/" rel="feed" type="application/rss+xml" title="That&#39;s it ! Code Snippets" />
    

    
    <link rel="canonical" href="https://thats-it-code.com/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/">
    

    <link rel="stylesheet" href="https://thats-it-code.com/theme.css">

    

    

    <script id="mcjs">!function(c,h,i,m,p){m=c.createElement(h),p=c.getElementsByTagName(h)[0],m.async=1,m.src=i,p.parentNode.insertBefore(m,p)}(document,"script","https://chimpstatic.com/mcjs-connected/js/users/0950ad66f63960c84d73e3b86/4df99a034fe04b743087ab3c2.js");</script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5756369302938289" crossorigin="anonymous"></script>

    
        <link rel="stylesheet" href="https://thats-it-code.com/css/custom_heading.css">
    
        <link rel="stylesheet" href="https://thats-it-code.com/css/custom.css">
    

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WNZ1JFLBDC"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-WNZ1JFLBDC');
    </script>
</head>

<body class="bilberry-hugo-theme">

    
    <nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="/categories/" target="_blank">Category</a></li>
                
            
                
                    <li><a href="https://thats-it-code.com/page/disclaimer/">Disclaimer</a></li>
                
            
                
                    <li><a href="https://thats-it-code.com/page/contact/">Contact</a></li>
                
            
                
                    <li><a href="/privacy.html" target="_blank">Privacy</a></li>
                
            
        </ul>

        
    </div>
</nav>


    
    <header>

        <div class="container">
            <div class="logo">
                <a href="/" class="logo">
                    
                        <img src="/img/avatar.png" alt="">
                    

                    <span class="overlay"><i class="fa fa-home"></i></span>
                </a>
            </div>
            <div class="titles">
                <h3 class="title">
                    <a href="/">
                        That&#39;s it ! Code Snippets
                    </a>
                </h3>

                
            </div>

            

            
                <div class="toggler permanentTopNav">
            
                    <i class="fa fa-bars" aria-hidden="true"></i>
                </div>
            </div>
    </header>


    <div class="main container">
        
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="https://thats-it-code.com/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/">
    <i class="fas fa-fw fa-code"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title">
        <a href="https://thats-it-code.com/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/">
            How to Extract Items of Invoice Using Form Recognizer API
        </a>
    </h1>

    <div class="meta">
        
            
                <span class="date moment">2022-01-12</span>
            
        

        

        
            <span class="categories">
                
                    
                    
                        <a href="https://thats-it-code.com/categories/ai-ocr/">AI-OCR</a>
                    
                
            </span>
        

        
    </div>

    
        
            <h2>Table of Contents</h2>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#download-sample-code-from-form-recognizer-studio">Download sample code from Form Recognizer Studio</a>
      <ul>
        <li>
          <ul>
            <li>
              <ul>
                <li><a href="#download-sample-code">Download sample code</a></li>
                <li><a href="#move-the-sample-code-to-project-folder">Move the sample code to project folder</a></li>
                <li><a href="#open-the-project-the-above-folder-with-visual-studio-code">Open the project (the above folder) with Visual Studio Code</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#setup-endpoint-and-key-for-calling-api">Setup endpoint and key for calling API</a></li>
    <li><a href="#install-necessary-library">Install necessary library</a></li>
    <li><a href="#execute-sample-code">Execute sample code</a></li>
    <li><a href="#extract-items-from-local-sample-invoice">Extract items from local sample invoice</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
        

        <p>In this article, we will talk about how to use Azure Form Recognizer API to <strong>extract items from an invoice</strong>.</p>
<p><img src="/img/formrec-api-thumnail.png" alt="Extract items from Invoice using API"></p>
<h2 id="download-sample-code-from-form-recognizer-studio">Download sample code from Form Recognizer Studio</h2>
<p>After using Azure Form Recognizer Studio to recognize sample invoice (<strong>You can read the article below</strong>), we can <strong>download the sample code</strong>.</p>
<blockquote>
<p><strong>How to Extract Items From Invoices Using Azure Form Recognizer</strong><br>
<a href="https://thats-it-code.com/azure/how-to-use-form-recognizer-to-extract-items-from-receipt/">https://thats-it-code.com/azure/how-to-use-form-recognizer-to-extract-items-from-receipt/</a></p>
</blockquote>
<h5 id="download-sample-code">Download sample code</h5>
<p><img src="1.png" alt="Extract items from Invoice using API"></p>
<p>After downloading the sample code (sample_analyze_invoices.py), move it to a new folder for extracting items from invoice using Form Recognizer API project.</p>
<h5 id="move-the-sample-code-to-project-folder">Move the sample code to project folder</h5>
<p><img src="2.png" alt="Extract items from Invoice using API"></p>
<p><img src="3.png" alt="Extract items from Invoice using API"></p>
<h5 id="open-the-project-the-above-folder-with-visual-studio-code">Open the project (the above folder) with Visual Studio Code</h5>
<p>Click [<strong>Open Folder</strong>] in VS Code and select the above folder.<br>
<img src="4.png" alt="Extract items from Invoice using API"></p>
<p><img src="5.png" alt="Extract items from Invoice using API"></p>
<p>You can read the article below to learn how to create a local development environment.</p>
<blockquote>
<p><strong>Lets Create a Programming Environment</strong><br>
<a href="https://thats-it-code.com/programming/lets-create-a-programming-environment/">https://thats-it-code.com/programming/lets-create-a-programming-environment/</a></p>
</blockquote>
<h2 id="setup-endpoint-and-key-for-calling-api">Setup endpoint and key for calling API</h2>
<p>Let&rsquo;s open the sample code, you will see <strong>endpoint</strong> and <strong>key</strong> variable is not set.</p>
<p><img src="eks-1.png" alt="Extract items from Invoice using API"></p>
<p>Let&rsquo;s go to Azure portal to get the two values.<br>
Firstly, enter &ldquo;<strong>congnitive services</strong>&rdquo; in the top search bar of Azure portal.<br>
And click &ldquo;<strong>Cognitive services multi-service account</strong>&rdquo; in the result list.</p>
<p><img src="eks-2.png" alt="Extract items from Invoice using API"></p>
<p>Click the service name.</p>
<p><img src="eks-3.png" alt="Extract items from Invoice using API"></p>
<p>Click [<strong>Keys and Endpoint</strong>] in the left-side menu.<br>
Click <strong>Copy</strong> button of [<strong>KEY 1</strong>] and [<strong>Endpoint</strong>]respectively and paste them to the <strong>endpoint</strong> and <strong>key</strong> variables of the sample code.</p>
<p><img src="eks-4.png" alt="Extract items from Invoice using API"></p>
<p><img src="eks-5.png" alt="Extract items from Invoice using API"></p>
<h2 id="install-necessary-library">Install necessary library</h2>
<p>To prevent pollution of the global python environment, we can use <strong>virtual environment</strong>.<br>
I use <strong>pipenv</strong> library to create and management python virtual environments.<br>
Firstly, let&rsquo;s install <strong>pipenv</strong> library using <strong>pip</strong> command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pip install pipenv
</code></pre></div><p><img src="exe-0.png" alt="Extract items from Invoice using API"></p>
<p>In the VS Code, press <strong>Ctrl+@</strong> to open terminal panel at the bottom of editor.<br>
And select <strong>Git Bash</strong> shell.<br>
<img src="exe-7.png" alt="Extract items from Invoice using API"></p>
<p>Execute the following command to <strong>create a new virtual environments based python 3</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pipenv --python <span style="color:#ae81ff">3</span>
</code></pre></div><p><img src="exe-1.png" alt="Extract items from Invoice using API"></p>
<p>And use the command below to enter the virtual environment.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pipenv shell
</code></pre></div><p><img src="exe-2.png" alt="Extract items from Invoice using API"></p>
<p>Now let&rsquo;s see what libraries are used in the sample code.<br>
As you can see, Azure Form Recognizer library is impoted.</p>
<p><img src="exe-8.png" alt="Extract items from Invoice using API"></p>
<p>Let&rsquo;s install azure form recognizer library.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pip install azure-ai-formrecognizer<span style="color:#f92672">==</span>3.2.0b2
</code></pre></div><p><img src="exe-3.png" alt="Extract items from Invoice using API"></p>
<p>But when finished installation, the import warnings still exist.<br>
We have to change the Python intepreter.</p>
<p><img src="exe-4.png" alt="Extract items from Invoice using API"></p>
<p>This time, the import warnings will gone.</p>
<p><img src="exe-11.png" alt="Extract items from Invoice using API"></p>
<h2 id="execute-sample-code">Execute sample code</h2>
<p>Next, let&rsquo;s execute the sample code.<br>
Execute the command below in the terminal panel at the bottom of VS Code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">python sample_analyze_invoices.py
</code></pre></div><p>The result below will show in the terminal.</p>
<p><img src="15.png" alt="Extract items from Invoice using API"></p>
<h2 id="extract-items-from-local-sample-invoice">Extract items from local sample invoice</h2>
<p>We can also extract invoice items from local files by modifying some lines.<br>
Firstly, let&rsquo;s prepare the local sample invoice file.<br>
Let&rsquo;s place the image below into <strong>data</strong> folder in project.<br>
This image is from Internet.</p>
<p><img src="sample-invoice.png" alt="Extract items from Invoice using API"></p>
<p>Let&rsquo;s comment out <strong>formUrl</strong> and replace it with <strong>opening the local invoice sample file</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># formUrl = &#34;https://raw.githubusercontent.com/Azure-Samples/cognitive-services-REST-api-samples/master/curl/form-recognizer/invoice_sample.jpg&#34;</span>
<span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;data/sample-invoice.png&#34;</span>, <span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
    formData <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</code></pre></div><p>And replace <strong>begin_analyze_document_from_url</strong> method with <strong>begin_analyze_document</strong> method.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># poller = document_analysis_client.begin_analyze_document_from_url(&#34;prebuilt-invoice&#34;, formUrl)</span>
poller <span style="color:#f92672">=</span> document_analysis_client<span style="color:#f92672">.</span>begin_analyze_document(<span style="color:#e6db74">&#34;prebuilt-invoice&#34;</span>, formData)
invoices <span style="color:#f92672">=</span> poller<span style="color:#f92672">.</span>result()
</code></pre></div><p>And let&rsquo;s execute our code again. The invoice items also be extracted successfully.</p>
<p><img src="local1.png" alt="Extract items from Invoice using API"></p>
<h2 id="conclusion">Conclusion</h2>
<p>In this article, we use Form Recognizer API to extract invoice items from invoice files.  We modified the sample code downloaded from Form Recognizer Studio page and extracted items from the local invoice file successfully.</p>

        
<link href="//cdn-images.mailchimp.com/embedcode/classic-10_7_dtp.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif;  width:600px;}
	 
</style>
<div id="mc_embed_signup">
<form action="https://thats-it-code.us17.list-manage.com/subscribe/post?u=0950ad66f63960c84d73e3b86&amp;id=4fcd6527d7&SIGNUP=" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<h3 style="margin-top: 50px; color: #4d78c8; font-size: 32px; font-family: 'Muli', sans-serif; ">Subscribe and be the FIRST reader of our latest articles</h3>
<div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
<div class="mc-field-group">
	<label for="mce-EMAIL">Email Address  <span class="asterisk">*</span>
</label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
</div>
	<div id="mce-responses" class="clear foot">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_0950ad66f63960c84d73e3b86_4fcd6527d7" tabindex="-1" value=""></div>
        <div class="optionalParent">
            <div class="clear foot">
                <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
                <p class="brandingLogo"><a href="http://eepurl.com/h0ORvf" title="Mailchimp - email marketing made easy and fun"><img src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg"></a></p>
            </div>
        </div>
    </div>
</form>
</div>
<script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='SIGNUP';ftypes[1]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>


        <form id="contact" action="https://formspree.io/f/mnqwoqyv" method="POST">
    <h3>Contact us</h3>
    <label>
        Your email:
        <input placeholder="Your Email Address" type="email" name="email">
    </label>
    <label>
        Your message:
        <textarea placeholder="Type your message here...." name="message"></textarea>
    </label>
    
    <button type="submit">Send</button>
</form>
        
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    
                    
                    <a href="https://thats-it-code.com/tags/azure/">Azure</a>
                    
                
                    
                    
                    <a href="https://thats-it-code.com/tags/form-recognizer/">Form Recognizer</a>
                    
                
                    
                    
                    <a href="https://thats-it-code.com/tags/ocr/">OCR</a>
                    
                
            </div>
        </div>
    

    
</div>

</article>

         
    </div>

    
        <div id="comments-container">
            
            

        </div>
    

    </div>

    

<section class="section sns_parent">
  <div class="container sns_section">
      <div class="sns_button twitter">
        <a href="http://twitter.com/intent/tweet?url=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f&text=How%20to%20Extract%20Items%20of%20Invoice%20Using%20Form%20Recognizer%20API" target="_blank" title="Tweet"><i class="fab fa-twitter"></i></a>
      </div>
      <div class="sns_button hatena">
        <a href="http://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f&title=How%20to%20Extract%20Items%20of%20Invoice%20Using%20Form%20Recognizer%20API" target="_blank" title="hatena"><i class="fa fa-hatena"></i></i></a>
      </div>
      <div class="sns_button facebook">
        <a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f&t=How%20to%20Extract%20Items%20of%20Invoice%20Using%20Form%20Recognizer%20API" target="_blank" title="Facebook"><i class="fab fa-facebook"></i></a>
      </div>
      <div class="sns_button google">
        <a href="https://plus.google.com/share?url=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f" target="_blank" title="google+"><i class="fab fa-google-plus"></i></a>
      </div>
      <div class="sns_button reddit">
        <a href="http://www.reddit.com/submit?url=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f&title=How%20to%20Extract%20Items%20of%20Invoice%20Using%20Form%20Recognizer%20API" target="_blank" title="Reddit"><i class="fab fa-reddit"></i></a>
      </div>
  </div>
</section>


    
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
            <ul>
                
                
                    <li>
                        <a href="https://thats-it-code.com/pandas/pandas__data-combination2-concat/">Pandas &gt;&gt; Data Combination(2): concat()</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/pandas/pandas__data-combination1-merge/">Pandas &gt;&gt; Data Combination(1): merge()</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/pandas/pandas__optimizing/">Pandas &gt;&gt; Optimization</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/pandas/pandas__3-ways-to-show-your-pandas-dataframe-as-a-pretty-table/">Pandas &gt;&gt; 3 Ways to Show Your Pandas DataFrame as a Pretty Table</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/pandas/pandas__data-type-conversions/">Pandas &gt;&gt; Data Type Conversions</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/pandas/pandas__dateoffset-timedelta-period/">Pandas &gt;&gt; DateOffset, Timedelta, Period</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/pandas/pandas__timestamp/">Pandas &gt;&gt; How to process Date and Time type data in Pandas using Timestamp</a>
                    </li>
                
            </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
            <ul>
                
                <li>
                    <a href="/categories/pandas">Pandas
                        (28)</a>
                </li>
                
                <li>
                    <a href="/categories/playwright">Playwright
                        (8)</a>
                </li>
                
                <li>
                    <a href="/categories/big-data">Big data
                        (5)</a>
                </li>
                
                <li>
                    <a href="/categories/ai-ocr">Ai ocr
                        (3)</a>
                </li>
                
                <li>
                    <a href="/categories/python">Python
                        (3)</a>
                </li>
                
                <li>
                    <a href="/categories/power-apps">Power apps
                        (2)</a>
                </li>
                
                <li>
                    <a href="/categories/azure">Azure
                        (1)</a>
                </li>
                
                <li>
                    <a href="/categories/programming">Programming
                        (1)</a>
                </li>
                
                <li>
                    <a href="/categories/python-library">Python library
                        (1)</a>
                </li>
                
            </ul>
        </div>
        

        <div class="right">
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://thats-it-code.com" target="_blank">
                &copy;
                
                2022
                
                by go3boy technology
            </a>
            
        </div>
        <div class="author">
            <a href="https://thats-it-code.com"
                target="_blank">That&#39;s it! Code Snippets</a>
        </div>
    </div>
</div>


    

    


    <script type="text/javascript" src="https://thats-it-code.com/theme.js"></script>

    

    
</body>

</html>
