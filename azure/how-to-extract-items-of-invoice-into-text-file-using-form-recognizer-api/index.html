
  
<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="siteBaseUrl" content="https://thats-it-code.com">
    <meta name="author" content="go3boy">
    <meta name="description" content="">
    <meta name="keywords" content="python,pandas,programming,tips,tricks,code snippets,code sample,code example,Rust, Cloud computing, AWS, Azure, GCP">
    <meta name="generator" content="Hugo 0.91.2" />
    <title>
        
           
               How to Extract Items of Invoice Using Form Recognizer API &vert; That&#39;s it ! Code Snippets
           
        
    </title>
    <meta name="description" content="How to Extract Items of Invoice Using Form Recognizer API - %!s(&lt;nil&gt;)">
    <meta itemprop="name" content="How to Extract Items of Invoice Using Form Recognizer API">
    <meta itemprop="description" content="How to Extract Items of Invoice Using Form Recognizer API - %!s(&lt;nil&gt;)">
    <meta property="og:title" content="How to Extract Items of Invoice Using Form Recognizer API">
    <meta property="og:description" content="How to Extract Items of Invoice Using Form Recognizer API - %!s(&lt;nil&gt;)">
    <meta property="og:image" content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200">
    <meta property="og:url" content="https://thats-it-code.com/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/">
    <meta property="og:site_name" content="That&#39;s it ! Code Snippets">
    <meta property="og:type" content="article">

    


    <script src="/modernizr-simple.js"></script>

    
    <link href="/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/" rel="alternate" type="application/rss+xml" title="That&#39;s it ! Code Snippets" />
    <link href="/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/" rel="feed" type="application/rss+xml" title="That&#39;s it ! Code Snippets" />
    

    
    <link rel="canonical" href="https://thats-it-code.com/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/">
    

    <link rel="stylesheet" href="https://thats-it-code.com/theme.css">

    

    
</head>

<body class="bilberry-hugo-theme">

    
    <nav>

    <div class="container">
        <ul class="topnav">
            
        </ul>

        
    </div>
</nav>


    
    <header>

        <div class="container">
            <div class="logo">
                <a href="/" class="logo">
                    
                        <img src="/img/avatar.png" alt="">
                    

                    <span class="overlay"><i class="fa fa-home"></i></span>
                </a>
            </div>
            <div class="titles">
                <h3 class="title">
                    <a href="/">
                        That&#39;s it ! Code Snippets
                    </a>
                </h3>

                
            </div>

            

            
                <div class="toggler">
            
                    <i class="fa fa-bars" aria-hidden="true"></i>
                </div>
            </div>
            

            
                <link rel="stylesheet" href="https://thats-it-code.com/css/custom_heading.css">
            
                <link rel="stylesheet" href="https://thats-it-code.com/css/custom.css">
            

            
            <script async src="https://www.googletagmanager.com/gtag/js?id=G-WNZ1JFLBDC"></script>
            <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-WNZ1JFLBDC');
            </script>
    </header>


    <div class="main container">
        
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="https://thats-it-code.com/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/">
    <i class="fas fa-fw fa-pencil-alt"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h1 class="article-title">
        <a href="https://thats-it-code.com/azure/how-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api/">
            How to Extract Items of Invoice Using Form Recognizer API
        </a>
    </h1>

    <div class="meta">
        
            
                <span class="date moment">2022-01-12</span>
            
        

        

        
            <span class="categories">
                
                    
                    
                        <a href="https://thats-it-code.com/categories/ai-ocr/">AI-OCR</a>
                    
                
            </span>
        

        
    </div>

    
        

        <p>In this article, we will talk about how to use Azure Form Recognizer API to <strong>extract items from an invoice</strong>.</p>
<ul>
<li>Download sample code from Form Recognizer Studio</li>
<li>Setup endpoint and key for calling API</li>
<li>Install necessary library</li>
<li>Execute sample code</li>
<li>Extract items from local sample invoice</li>
<li>Conclusion</li>
</ul>
<p><img src="/img/formrec-api-thumnail.png" alt="Extract items from Invoice using API"></p>
<h2 id="download-sample-code-from-form-recognizer-studio">Download sample code from Form Recognizer Studio</h2>
<p>After using Azure Form Recognizer Studio to recognize sample invoice (<strong>You can read the article below</strong>), we can <strong>download the sample code</strong>.</p>
<blockquote>
<p><strong>How to Extract Items From Invoices Using Azure Form Recognizer</strong><br>
<a href="https://thats-it-code.com/azure/how-to-use-form-recognizer-to-extract-items-from-receipt/">https://thats-it-code.com/azure/how-to-use-form-recognizer-to-extract-items-from-receipt/</a></p>
</blockquote>
<h5 id="download-sample-code">Download sample code</h5>
<p><img src="1.png" alt="Extract items from Invoice using API"></p>
<p>After downloading the sample code (sample_analyze_invoices.py), move it to a new folder for extracting items from invoice using Form Recognizer API project.</p>
<h5 id="move-the-sample-code-to-project-folder">Move the sample code to project folder</h5>
<p><img src="2.png" alt="Extract items from Invoice using API"></p>
<p><img src="3.png" alt="Extract items from Invoice using API"></p>
<h5 id="open-the-project-the-above-folder-with-visual-studio-code">Open the project (the above folder) with Visual Studio Code</h5>
<p>Click [<strong>Open Folder</strong>] in VS Code and select the above folder.<br>
<img src="4.png" alt="Extract items from Invoice using API"></p>
<p><img src="5.png" alt="Extract items from Invoice using API"></p>
<p>You can read the article below to learn how to create a local development environment.</p>
<blockquote>
<p><strong>Lets Create a Programming Environment</strong><br>
<a href="https://thats-it-code.com/programming/lets-create-a-programming-environment/">https://thats-it-code.com/programming/lets-create-a-programming-environment/</a></p>
</blockquote>
<h2 id="setup-endpoint-and-key-for-calling-api">Setup endpoint and key for calling API</h2>
<p>Let&rsquo;s open the sample code, you will see <strong>endpoint</strong> and <strong>key</strong> variable is not set.</p>
<p><img src="eks-1.png" alt="Extract items from Invoice using API"></p>
<p>Let&rsquo;s go to Azure portal to get the two values.<br>
Firstly, enter &ldquo;<strong>congnitive services</strong>&rdquo; in the top search bar of Azure portal.<br>
And click &ldquo;<strong>Cognitive services multi-service account</strong>&rdquo; in the result list.</p>
<p><img src="eks-2.png" alt="Extract items from Invoice using API"></p>
<p>Click the service name.</p>
<p><img src="eks-3.png" alt="Extract items from Invoice using API"></p>
<p>Click [<strong>Keys and Endpoint</strong>] in the left-side menu.<br>
Click <strong>Copy</strong> button of [<strong>KEY 1</strong>] and [<strong>Endpoint</strong>]respectively and paste them to the <strong>endpoint</strong> and <strong>key</strong> variables of the sample code.</p>
<p><img src="eks-4.png" alt="Extract items from Invoice using API"></p>
<p><img src="eks-5.png" alt="Extract items from Invoice using API"></p>
<h2 id="install-necessary-library">Install necessary library</h2>
<p>To prevent pollution of the global python environment, we can use <strong>virtual environment</strong>.<br>
I use <strong>pipenv</strong> library to create and management python virtual environments.<br>
Firstly, let&rsquo;s install <strong>pipenv</strong> library using <strong>pip</strong> command.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pip install pipenv
</code></pre></div><p><img src="exe-0.png" alt="Extract items from Invoice using API"></p>
<p>In the VS Code, press <strong>Ctrl+@</strong> to open terminal panel at the bottom of editor.<br>
And select <strong>Git Bash</strong> shell.<br>
<img src="exe-7.png" alt="Extract items from Invoice using API"></p>
<p>Execute the following command to <strong>create a new virtual environments based python 3</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pipenv --python <span style="color:#ae81ff">3</span>
</code></pre></div><p><img src="exe-1.png" alt="Extract items from Invoice using API"></p>
<p>And use the command below to enter the virtual environment.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pipenv shell
</code></pre></div><p><img src="exe-2.png" alt="Extract items from Invoice using API"></p>
<p>Now let&rsquo;s see what libraries are used in the sample code.<br>
As you can see, Azure Form Recognizer library is impoted.</p>
<p><img src="exe-8.png" alt="Extract items from Invoice using API"></p>
<p>Let&rsquo;s install azure form recognizer library.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pip install azure-ai-formrecognizer<span style="color:#f92672">==</span>3.2.0b2
</code></pre></div><p><img src="exe-3.png" alt="Extract items from Invoice using API"></p>
<p>But when finished installation, the import warnings still exist.<br>
We have to change the Python intepreter.</p>
<p><img src="exe-4.png" alt="Extract items from Invoice using API"></p>
<p>This time, the import warnings will gone.</p>
<p><img src="exe-11.png" alt="Extract items from Invoice using API"></p>
<h2 id="execute-sample-code">Execute sample code</h2>
<p>Next, let&rsquo;s execute the sample code.<br>
Execute the command below in the terminal panel at the bottom of VS Code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">python sample_analyze_invoices.py
</code></pre></div><p>The result below will show in the terminal.</p>
<p><img src="15.png" alt="Extract items from Invoice using API"></p>
<h2 id="extract-items-from-local-sample-invoice">Extract items from local sample invoice</h2>
<p>We can also extract invoice items from local files by modifying some lines.<br>
Firstly, let&rsquo;s prepare the local sample invoice file.<br>
Let&rsquo;s place the image below into <strong>data</strong> folder in project.<br>
This image is from Internet.</p>
<p><img src="sample-invoice.png" alt="Extract items from Invoice using API"></p>
<p>Let&rsquo;s comment out <strong>formUrl</strong> and replace it with <strong>opening the local invoice sample file</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># formUrl = &#34;https://raw.githubusercontent.com/Azure-Samples/cognitive-services-REST-api-samples/master/curl/form-recognizer/invoice_sample.jpg&#34;</span>
<span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;data/sample-invoice.png&#34;</span>, <span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
    formData <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</code></pre></div><p>And replace <strong>begin_analyze_document_from_url</strong> method with <strong>begin_analyze_document</strong> method.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># poller = document_analysis_client.begin_analyze_document_from_url(&#34;prebuilt-invoice&#34;, formUrl)</span>
poller <span style="color:#f92672">=</span> document_analysis_client<span style="color:#f92672">.</span>begin_analyze_document(<span style="color:#e6db74">&#34;prebuilt-invoice&#34;</span>, formData)
invoices <span style="color:#f92672">=</span> poller<span style="color:#f92672">.</span>result()
</code></pre></div><p>And let&rsquo;s execute our code again. The invoice items also be extracted successfully.</p>
<p><img src="local1.png" alt="Extract items from Invoice using API"></p>
<h2 id="conclusion">Conclusion</h2>
<p>In this article, we use Form Recognizer API to extract invoice items from invoice files.  We modified the sample code downloaded from Form Recognizer Studio page and extracted items from the local invoice file successfully.</p>
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

        
        
    </div>

    
        <div id="comments-container">
            
            

        </div>
    

    </div>

    

<section class="section sns_parent">
  <div class="container sns_section">
      <div class="sns_button twitter">
        <a href="http://twitter.com/intent/tweet?url=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f&text=How%20to%20Extract%20Items%20of%20Invoice%20Using%20Form%20Recognizer%20API" target="_blank" title="Tweet"><i class="fab fa-twitter"></i></a>
      </div>
      <div class="sns_button hatena">
        <a href="http://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f&title=How%20to%20Extract%20Items%20of%20Invoice%20Using%20Form%20Recognizer%20API" target="_blank" title="hatena"><i class="fa fa-hatena"></i></i></a>
      </div>
      <div class="sns_button facebook">
        <a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f&t=How%20to%20Extract%20Items%20of%20Invoice%20Using%20Form%20Recognizer%20API" target="_blank" title="Facebook"><i class="fab fa-facebook"></i></a>
      </div>
      <div class="sns_button google">
        <a href="https://plus.google.com/share?url=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f" target="_blank" title="google+"><i class="fab fa-google-plus"></i></a>
      </div>
      <div class="sns_button reddit">
        <a href="http://www.reddit.com/submit?url=https%3a%2f%2fthats-it-code.com%2fazure%2fhow-to-extract-items-of-invoice-into-text-file-using-form-recognizer-api%2f&title=How%20to%20Extract%20Items%20of%20Invoice%20Using%20Form%20Recognizer%20API" target="_blank" title="Reddit"><i class="fab fa-reddit"></i></a>
      </div>
  </div>
</section>

    
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
            <ul>
                
                
                    <li>
                        <a href="https://thats-it-code.com/playwright/playwright-example__radiobutton/">Playwright Example &gt;&gt; RadioButton</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/playwright/playwright-example__download-file/">Playwright Example &gt;&gt; Download File</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/pandas/how-to-convert-multivalue-column-to-multiple-rows/">Pandas &gt;&gt; How to Convert a Multi-Value Column to Multiple Rows</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/playwright/playwright-example__upload-files/">Playwright Example &gt;&gt; Upload Files</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/playwright/playwright-example__checkbox/">Playwright Example &gt;&gt; Checkbox</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/playwright/playwright-example__textbox/">Playwright Example &gt;&gt; TextBox</a>
                    </li>
                
                    <li>
                        <a href="https://thats-it-code.com/python/create-an-interactive-web-app-for-data-science-in-10-minutes-with-streamlit/">Create an Interactive Web App for Data Science in 10 Minutes With Streamlit</a>
                    </li>
                
            </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
            <ul>
                
                <li>
                    <a href="/categories/pandas">Pandas
                        (20)</a>
                </li>
                
                <li>
                    <a href="/categories/playwright">Playwright
                        (7)</a>
                </li>
                
                <li>
                    <a href="/categories/ai-ocr">Ai ocr
                        (3)</a>
                </li>
                
                <li>
                    <a href="/categories/programming">Programming
                        (3)</a>
                </li>
                
                <li>
                    <a href="/categories/python">Python
                        (2)</a>
                </li>
                
                <li>
                    <a href="/categories/apache-spark">Apache spark
                        (1)</a>
                </li>
                
                <li>
                    <a href="/categories/openpyxl">Openpyxl
                        (1)</a>
                </li>
                
            </ul>
        </div>
        

        <div class="right">
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://thats-it-code.com" target="_blank">
                &copy;
                
                2022
                
                by go3boy
            </a>
            
        </div>
        <div class="author">
            <a href="https://thats-it-code.com"
                target="_blank">That&#39;s it! Code Snippets</a>
        </div>
    </div>
</div>


    

    


    <script type="text/javascript" src="https://thats-it-code.com/theme.js"></script>

    

    
</body>

</html>
